<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Daj mi swoje pieniƒÖdze ‚Äî Sigmo</title>
  <style>
    :root{
      --bg:#0f3;
      --fg:#000;
      --card: rgba(255,255,255,0.85);
      --accent:#0070ba;
      --btn-text:#fff;
    }
    /* dark theme vars */
    .theme-dark { --bg:#111; --fg:#eee; --card: rgba(0,0,0,0.65); --accent:#444; --btn-text:#fff; }
    body {
      background: var(--bg);
      color: var(--fg);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Courier New", monospace;
      margin:0;
      min-height:100vh;
      display:flex;
      flex-direction:column;
      align-items:center;
      padding:18px;
      box-sizing:border-box;
      transition: background .35s ease, color .35s ease;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }

    header{ width:100%; max-width:980px; display:flex; align-items:center; justify-content:space-between; gap:12px; }
    h1{
      font-size:clamp(1.6rem,4.5vw,2.4rem);
      margin:6px 0;
      text-align:center;
      user-select:none;
      cursor:pointer;
      padding:6px;
    }
    .sub {
      max-width:980px;
      text-align:center;
      margin:6px 0 14px;
      font-size:clamp(0.95rem,2.6vw,1.1rem);
      opacity:0.95;
    }

    /* buttons row */
    .controls {
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      justify-content:center;
      margin:8px 0 14px;
    }
    .btn {
      background:var(--accent);
      color:var(--btn-text);
      border:0;
      border-radius:10px;
      padding:10px 14px;
      font-weight:700;
      font-size:0.98rem;
      cursor:pointer;
      box-shadow: 0 6px 18px rgba(0,0,0,0.12);
      transition: transform .12s ease, box-shadow .12s ease;
      user-select:none;
    }
    .btn:active{ transform:translateY(1px) scale(.995); }
    .btn.secondary{ background:transparent; color:var(--fg); border:1px solid rgba(0,0,0,0.12); }

    /* layout: main + sidebar/ stats */
    .grid {
      width:100%;
      max-width:980px;
      display:grid;
      grid-template-columns: 1fr 320px;
      gap:18px;
      align-items:start;
    }
    @media (max-width:900px){
      .grid { grid-template-columns: 1fr; }
    }

    /* main area (games) */
    .card {
      background: var(--card);
      border-radius:12px;
      padding:14px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.08);
    }

    .game-title { font-weight:800; margin-bottom:8px; }

    .coin-big {
      display:inline-block;
      font-size:3.6rem;
      line-height:1;
      padding:8px;
      border-radius:12px;
      cursor:pointer;
      user-select:none;
      transition: transform .06s ease, box-shadow .12s ease;
      box-shadow: 0 6px 14px rgba(0,0,0,0.12);
      background: linear-gradient(180deg, rgba(255,255,255,0.2), transparent);
    }
    .coin-big:active{ transform: scale(.96) rotate(-6deg); }

    /* floating small timer */
    .session-timer {
      position:fixed;
      top:12px;
      right:12px;
      background:var(--card);
      color:var(--fg);
      padding:8px 10px;
      border-radius:10px;
      font-weight:700;
      box-shadow: 0 8px 20px rgba(0,0,0,0.08);
      z-index:60;
    }

    /* stats panel */
    .stats {
      display:flex;
      flex-direction:column;
      gap:8px;
      min-width:220px;
    }
    .stat-row{ display:flex; justify-content:space-between; align-items:center; padding:8px 6px; border-radius:8px; background: rgba(0,0,0,0.03); font-weight:700; }
    .stat-title{ opacity:0.85; font-weight:600; font-size:0.95rem; }
    .stat-value{ font-weight:800; color:var(--fg); }

    /* theme panel */
    .themes { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; margin-top:8px; }
    .theme-swatch{ width:38px; height:28px; border-radius:6px; cursor:pointer; border:2px solid rgba(255,255,255,0.2); box-shadow:0 4px 12px rgba(0,0,0,0.08); }

    /* canvas drawer */
    .drawer {
      margin-top:12px;
      display:flex;
      flex-direction:column;
      gap:8px;
      align-items:center;
    }
    canvas#drawCanvas { border-radius:8px; border:1px solid rgba(0,0,0,0.08); background:white; touch-action: none; }

    footer{
      width:100%;
      max-width:980px;
      margin-top:18px;
      padding:10px 12px;
      border-top:1px solid rgba(0,0,0,0.06);
      text-align:center;
      color:var(--fg);
      opacity:0.9;
      font-size:0.95rem;
    }

    /* coin spawn game styling */
    .spawn-coin {
      position:absolute;
      font-size:2.4rem;
      cursor:pointer;
      user-select:none;
      transition: transform .08s ease;
      text-shadow: 0 6px 18px rgba(0,0,0,0.12);
    }

    /* VIP title style */
    .vip { color:gold; text-shadow: 0 2px 8px rgba(0,0,0,0.25); }

  </style>
</head>
<body>

  <div class="session-timer" id="sessionTimer">Sesja: 0s</div>

  <header style="width:100%; max-width:980px; display:flex; align-items:center; justify-content:space-between;">
    <h1 id="title">üí∏ Daj mi swoje pieniƒÖdze üí∏</h1>
    <div style="display:flex; gap:10px; align-items:center;">
      <div id="musicToggle" title="Muzyka (kliknij)">üéß</div>
      <a class="btn" href="https://buycoffee.to/olekkosciuczyk" target="_blank" rel="noopener">Wp≈Çaƒá mi 5 z≈Çoty</a>
    </div>
  </header>

  <p class="sub">Jeste≈õ tu ju≈º chwilƒô ‚Äî zr√≥b dobry uczynek, zagraj albo narysuj co≈õ. Wszystko jest local, nikt tu nie wyciƒÖga twojego maila. </p>

  <div class="grid" role="main">
    <!-- MAIN COLUMN -->
    <div class="card" style="position:relative;">
      <!-- Controls row -->
      <div class="controls" style="justify-content:flex-start;">
        <button class="btn" id="btn-random">Losuj kwotƒô</button>
        <button class="btn" id="btn-start-g1">Start ‚Äî gra 1 (1 moneta 10s)</button>
        <button class="btn" id="btn-start-g2">Start ‚Äî gra 2 (spawn 10s)</button>
        <button class="btn secondary" id="btn-reset-stats" title="Resetuje lokalne statsy">Reset stat√≥w</button>
      </div>

      <!-- Game 1 -->
      <section style="margin-top:10px;">
        <div class="game-title">üéØ Gra 1 ‚Äî Klikaj jednƒÖ monetƒô</div>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <div id="g1-timer" style="font-weight:800">Czas: 0s</div>
          <div id="g1-score" style="font-weight:800">Wynik: 0</div>
          <div id="g1-best" style="font-weight:800">Rekord: 0</div>
        </div>
        <div style="margin-top:12px;">
          <span id="coin-btn" class="coin-big" title="Kliknij mnie!">ü™ô</span>
        </div>
      </section>

      <hr style="margin:14px 0; border:none; height:1px; background:rgba(0,0,0,0.06)">

      <!-- Game 2 -->
      <section>
        <div class="game-title">üéÆ Gra 2 ‚Äî ≈ÅapajƒÖce monety</div>
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <div id="g2-timer" style="font-weight:800">Czas: 0s</div>
          <div id="g2-score" style="font-weight:800">Wynik: 0</div>
          <div id="g2-best" style="font-weight:800">Rekord: 0</div>
        </div>
        <div style="margin-top:12px; font-size:0.95rem; opacity:0.95;">Monety pojawiajƒÖ siƒô w losowych miejscach ‚Äî klikaj je szybko!</div>
      </section>

      <!-- Random amount result -->
      <div style="margin-top:12px; font-weight:800;">Ostatnio wylosowano: <span id="last-random">0 z≈Ç</span></div>

      <!-- Drawing canvas -->
      <div class="drawer card" style="margin-top:16px;">
        <div style="font-weight:800; margin-bottom:6px;">‚úèÔ∏è Rysuj tu (dotyk / mysz)</div>
        <canvas id="drawCanvas" width="600" height="240" style="max-width:100%; width:100%; height:auto;"></canvas>
        <div style="display:flex; gap:10px; margin-top:8px;">
          <button class="btn secondary" id="clearCanvas">üîÑ Wyczy≈õƒá rysunek</button>
          <button class="btn secondary" id="toggleDrawColor">üé® Zmie≈Ñ kolor</button>
        </div>
      </div>

    </div>

    <!-- SIDEBAR: stats + themes -->
    <aside>
      <div class="card stats" style="width:320px; max-width:92vw;">
        <div style="font-weight:900; margin-bottom:6px;">üìä Twoje statystyki (lokalne)</div>
        <div class="stat-row"><div class="stat-title">Wizyty:</div><div class="stat-value" id="stat-visits">0</div></div>
        <div class="stat-row"><div class="stat-title">≈ÅƒÖczne klikniƒôcia:</div><div class="stat-value" id="stat-clicks">0</div></div>
        <div class="stat-row"><div class="stat-title">≈ÅƒÖczny czas (s):</div><div class="stat-value" id="stat-time">0</div></div>
        <div class="stat-row"><div class="stat-title">Rekord G1 (10s):</div><div class="stat-value" id="stat-g1best">0</div></div>
        <div class="stat-row"><div class="stat-title">Rekord G2 (10s):</div><div class="stat-value" id="stat-g2best">0</div></div>
        <div style="margin-top:10px; font-size:0.95rem; opacity:0.9;">Motywy:</div>
        <div class="themes" id="themeSwatches" style="margin-top:8px;">
          <!-- swatches inserted by JS -->
        </div>
      </div>
    </aside>
  </div>

  <footer>
    ¬© 2025 Olek Ko≈õciuczyk ‚Äî <a href="https://www.instagram.com/_sigmolocix_/" target="_blank" rel="noopener">@_sigmolocix_</a> ‚Ä¢ Link: <a href="https://buycoffee.to/olekkosciuczyk" target="_blank" rel="noopener">buycoffee.to</a>
  </footer>

  <!-- rickroll audio (toggle) -->
  <audio id="rickAudio" preload="none" src="https://www.radiantmediaplayer.com/media/big-buck-bunny-360p.mp4"></audio>

<script>
/* =======================
   Local stats & init
   ======================= */
const LS = {
  visits: 'dmk_visits',
  clicks: 'dmk_clicks',
  time: 'dmk_time',
  g1best: 'dmk_g1best',
  g2best: 'dmk_g2best',
  lastRandom: 'dmk_lastRandom'
};

function num(v){return parseInt(v||0,10);}
let stats = {
  visits: num(localStorage.getItem(LS.visits)),
  clicks: num(localStorage.getItem(LS.clicks)),
  time: num(localStorage.getItem(LS.time)),
  g1best: num(localStorage.getItem(LS.g1best)),
  g2best: num(localStorage.getItem(LS.g2best)),
  lastRandom: localStorage.getItem(LS.lastRandom) || '0 z≈Ç'
};
// increment visits
stats.visits++;
localStorage.setItem(LS.visits, stats.visits);

// ui nodes
const elVisits = document.getElementById('stat-visits');
const elClicks = document.getElementById('stat-clicks');
const elTime = document.getElementById('stat-time');
const elG1best = document.getElementById('stat-g1best');
const elG2best = document.getElementById('stat-g2best');
const elLastRandom = document.getElementById('last-random');

function renderStatsUI(){
  elVisits.textContent = stats.visits;
  elClicks.textContent = stats.clicks;
  elTime.textContent = stats.time;
  elG1best.textContent = stats.g1best;
  elG2best.textContent = stats.g2best;
  elLastRandom.textContent = stats.lastRandom;
}
renderStatsUI();

/* =======================
   Session timer (top right) & total time accumulate
   ======================= */
let sessionSeconds = 0;
const sessionTimerEl = document.getElementById('sessionTimer');
setInterval(()=>{
  sessionSeconds++;
  sessionTimerEl.textContent = `Sesja: ${sessionSeconds}s`;
  stats.time++;
  if(sessionSeconds % 5 === 0){ // save occasionally
    localStorage.setItem(LS.time, stats.time);
    renderStatsUI();
  } else {
    elTime.textContent = stats.time;
  }
  // bieda mode after 5 minutes total time in storage
  if (stats.time === 300) {
    activateBiedaMode();
  }
},1000);

/* =======================
   Bieda mode
   ======================= */
function activateBiedaMode(){
  document.body.style.filter = 'grayscale(100%)';
  setTimeout(()=>alert('üíÄ Bieda mode: serio, id≈∫ ruszyƒá dupƒô i zarobiƒá'),50);
}

/* =======================
   CLICK HANDLER (coin button & global click counts)
   ======================= */
const coinBtn = document.getElementById('coin-btn');
coinBtn.addEventListener('click', () => {
  // allow clicking outside of active games so user still contributes to totalClicks
  stats.clicks++;
  localStorage.setItem(LS.clicks, stats.clicks);
  elClicks.textContent = stats.clicks;
  // small pop effect
  coinBtn.style.transform = 'scale(1.06) rotate(-6deg)';
  setTimeout(()=>coinBtn.style.transform = '',80);
});

/* =======================
   Random amount button
   ======================= */
const btnRandom = document.getElementById('btn-random');
btnRandom.addEventListener('click', ()=>{
  const amount = (Math.floor(Math.random()*20)+1) * 5; // 5..100 step 5
  stats.lastRandom = `${amount} z≈Ç`;
  localStorage.setItem(LS.lastRandom, stats.lastRandom);
  document.getElementById('last-random').textContent = stats.lastRandom;
  // hint: open buy link with coffees param (optional)
  // window.open(`https://buycoffee.to/olekkosciuczyk?c=${Math.ceil(amount/5)}`, '_blank');
});

/* =======================
   Game 1 - single coin 10s
   ======================= */
let g1Time = 10, g1Score = 0, g1Interval = null;
const g1TimerEl = document.getElementById('g1-timer');
const g1ScoreEl = document.getElementById('g1-score');
const g1BestEl = document.getElementById('g1-best');

g1BestEl.textContent = stats.g1best;

function startG1(){
  if(g1Interval) return; // already running
  g1Score = 0;
  g1Time = 10;
  g1TimerEl.textContent = `Czas: ${g1Time}s`;
  g1ScoreEl.textContent = `Wynik: ${g1Score}`;
  g1Interval = setInterval(()=>{
    g1Time--;
    g1TimerEl.textContent = `Czas: ${g1Time}s`;
    if(g1Time <= 0){
      clearInterval(g1Interval); g1Interval = null;
      finishG1();
    }
  },1000);
}
function finishG1(){
  // update best
  if(g1Score > stats.g1best){
    stats.g1best = g1Score;
    localStorage.setItem(LS.g1best, stats.g1best);
    elG1best.textContent = stats.g1best;
    // VIP crown title
    document.getElementById('title').classList.add('vip');
    document.getElementById('title').textContent = 'üëë Kr√≥l monet ‚Äî pobi≈Çe≈õ rekord! üëë';
    setTimeout(()=>{ /* keep title flashy for 6s then maybe reset */ }, 6000);
  }
  alert(`Koniec! Wynik: ${g1Score}`);
  // already counted clicks in coin click listener
  renderStatsUI();
}
document.getElementById('btn-start-g1').addEventListener('click', startG1);

// coin click increments g1Score only during g1 active
coinBtn.addEventListener('click', ()=>{
  if(g1Interval){
    g1Score++;
    g1ScoreEl.textContent = `Wynik: ${g1Score}`;
  }
});

/* =======================
   Game 2 - spawn coins 10s
   ======================= */
let g2Active = false;
let g2Score = 0;
let g2IntervalMain = null;
const g2ScoreEl = document.getElementById('g2-score');
const g2BestEl = document.getElementById('g2-best');
g2BestEl.textContent = stats.g2best;

function startG2(){
  if(g2Active) return;
  g2Active = true;
  g2Score = 0;
  g2ScoreEl.textContent = `Wynik: ${g2Score}`;
  let time = 10;
  g2IntervalMain = setInterval(()=>{
    spawnMovingCoin();
    time--;
    document.getElementById('g2-timer').textContent = `Czas: ${time}s`;
    if(time <= 0){
      clearInterval(g2IntervalMain);
      g2Active = false;
      finishG2();
      document.getElementById('g2-timer').textContent = `Czas: 0s`;
    }
  }, 700); // spawn every 700ms
}
function spawnMovingCoin(){
  const c = document.createElement('div');
  c.className = 'spawn-coin';
  c.textContent = 'ü™ô';
  // random pos but not under header/footer. Use viewport
  const w = Math.max(window.innerWidth, 300);
  const h = Math.max(window.innerHeight, 300);
  const left = Math.random()*(w-60);
  const top = Math.random()*(h-160);
  c.style.left = `${left}px`;
  c.style.top = `${top}px`;
  document.body.appendChild(c);
  c.addEventListener('click', ()=>{
    g2Score++;
    stats.clicks++; localStorage.setItem(LS.clicks, stats.clicks); elClicks.textContent = stats.clicks;
    g2ScoreEl.textContent = `Wynik: ${g2Score}`;
    c.remove();
  });
  // auto-remove after 900ms
  setTimeout(()=>{ if(document.body.contains(c)) c.remove(); }, 900);
}
function finishG2(){
  // update best
  if(g2Score > stats.g2best){
    stats.g2best = g2Score;
    localStorage.setItem(LS.g2best, stats.g2best);
    elG2best.textContent = stats.g2best;
    document.getElementById('title').classList.add('vip');
    document.getElementById('title').textContent = 'üëë Kr√≥l monet ‚Äî pobi≈Çe≈õ rekord! üëë';
  }
  alert(`Koniec gry 2! Wynik: ${g2Score}`);
  renderStatsUI();
}
document.getElementById('btn-start-g2').addEventListener('click', startG2);

/* =======================
   Random-calc: amount -> open buy link with count param (optional)
   ======================= */
document.getElementById('btn-random').addEventListener('click', ()=>{
  const amount = (Math.floor(Math.random()*20)+1)*5; // 5..100
  stats.lastRandom = `${amount} z≈Ç`;
  localStorage.setItem(LS.lastRandom, stats.lastRandom);
  document.getElementById('last-random').textContent = stats.lastRandom;
  // optional: open buycoffee with coffees param => Math.ceil(amount/5)
  // window.open(`https://buycoffee.to/olekkosciuczyk?c=${Math.ceil(amount/5)}`,'_blank');
});

/* =======================
   Reset stats
   ======================= */
document.getElementById('btn-reset-stats').addEventListener('click', ()=>{
  if(!confirm('Na bank chcesz wyczy≈õciƒá lokalne statsy?')) return;
  for(const k of Object.values(LS)) localStorage.removeItem(k);
  stats = { visits:0, clicks:0, time:0, g1best:0, g2best:0, lastRandom:'0 z≈Ç' };
  localStorage.setItem(LS.visits, 0);
  location.reload();
});

/* =======================
   THEMES: 6 swatches + easter egg (3x title click toggles theme)
   ======================= */
const THEMES = [
  {name:'Zielony banknot', bg: 'linear-gradient(135deg,#0f3,#baff00)', fg:'#000'},
  {name:'S≈Çoneczny', bg: 'linear-gradient(135deg,#ffef6b,#ffb347)', fg:'#000'},
  {name:'Ognisty', bg: 'linear-gradient(135deg,#ff4d4d,#ff9966)', fg:'#000'},
  {name:'Ocean', bg: 'linear-gradient(135deg,#00d2ff,#3a7bd5)', fg:'#fff'},
  {name:'Fiolet', bg: 'linear-gradient(135deg,#f093fb,#f5576c)', fg:'#fff'},
  {name:'Nocny', bg: '#111', fg:'#eee'}
];
const swatchesContainer = document.getElementById('themeSwatches');
THEMES.forEach((t,i)=>{
  const s = document.createElement('div');
  s.className = 'theme-swatch';
  s.title = t.name;
  if(t.bg.startsWith('linear')) s.style.background = t.bg;
  else s.style.background = t.bg;
  s.addEventListener('click', ()=>{
    applyTheme(i);
    localStorage.setItem('dmk_theme', i);
  });
  swatchesContainer.appendChild(s);
});
function applyTheme(index){
  const t = THEMES[index];
  document.body.style.background = t.bg;
  document.body.style.color = t.fg;
  // tweak card bg for readability
  const cards = document.querySelectorAll('.card, .session-timer, footer, .stats');
  cards.forEach(c=>{
    if (index === 5) c.style.background = 'rgba(0,0,0,0.6)';
    else c.style.background = 'rgba(255,255,255,0.85)';
  });
}
// restore theme
const savedTheme = localStorage.getItem('dmk_theme');
if(savedTheme){ applyTheme(Number(savedTheme)); }

/* title click easter egg: 3 rapid clicks cycles to next theme */
let tClicks = 0, tLast = 0;
document.getElementById('title').addEventListener('click', ()=>{
  const now = Date.now();
  if(now - tLast < 600) tClicks++; else tClicks = 1;
  tLast = now;
  if(tClicks >= 3){
    // cycle theme
    let idx = Number(localStorage.getItem('dmk_theme') || 0);
    idx = (idx + 1) % THEMES.length;
    applyTheme(idx);
    localStorage.setItem('dmk_theme', idx);
    tClicks = 0;
  }
});

/* =======================
   RICKROLL / MUSIC toggle
   ======================= */
const rick = document.getElementById('rickAudio');
const musicToggle = document.getElementById('musicToggle');
musicToggle.addEventListener('click', ()=>{
  // toggle play/pause
  if(rick.paused){
    // try to play; if blocked, open youtube as fallback
    rick.play().catch(()=> window.open('https://www.youtube.com/watch?v=dQw4w9WgXcQ','_blank'));
    musicToggle.textContent = 'üîä';
  } else {
    rick.pause();
    musicToggle.textContent = 'üéß';
  }
});

/* =======================
   DRAW CANVAS
   ======================= */
const canvas = document.getElementById('drawCanvas');
const ctx = canvas.getContext('2d');
let drawing=false, lastX=0, lastY=0;
let drawColor = '#000';
canvas.addEventListener('pointerdown', (e)=>{
  drawing = true;
  const r = canvas.getBoundingClientRect();
  lastX = e.clientX - r.left;
  lastY = e.clientY - r.top;
});
canvas.addEventListener('pointerup', ()=>{ drawing=false; ctx.beginPath(); });
canvas.addEventListener('pointercancel', ()=>{ drawing=false; ctx.beginPath(); });
canvas.addEventListener('pointermove', (e)=>{
  if(!drawing) return;
  const r = canvas.getBoundingClientRect();
  const x = e.clientX - r.left;
  const y = e.clientY - r.top;
  ctx.lineJoin = 'round';
  ctx.lineCap = 'round';
  ctx.strokeStyle = drawColor;
  ctx.lineWidth = 3;
  ctx.beginPath();
  ctx.moveTo(lastX, lastY);
  ctx.lineTo(x,y);
  ctx.stroke();
  lastX = x; lastY = y;
});
document.getElementById('clearCanvas').addEventListener('click', ()=>{
  ctx.clearRect(0,0,canvas.width,canvas.height);
});
document.getElementById('toggleDrawColor').addEventListener('click', ()=>{
  drawColor = (drawColor === '#000') ? '#ff0066' : '#000';
});

/* =======================
   Save stats periodically (safety)
   ======================= */
setInterval(()=> {
  localStorage.setItem(LS.clicks, stats.clicks);
  localStorage.setItem(LS.time, stats.time);
  localStorage.setItem(LS.g1best, stats.g1best);
  localStorage.setItem(LS.g2best, stats.g2best);
  localStorage.setItem(LS.lastRandom, stats.lastRandom);
}, 5000);

/* =======================
   Ensure UI updated on load
   ======================= */
function elById(id){ return document.getElementById(id); }
elById('g1-best').textContent = `Rekord: ${stats.g1best}`;
elById('g2-best').textContent = `Rekord: ${stats.g2best}`;
document.getElementById('last-random').textContent = stats.lastRandom;
renderStatsUI();

/* =======================
   Prevent text selection pestering on mobile/touch
   ======================= */
document.addEventListener('touchstart', ()=>{}, {passive:true});
document.body.style.webkitTapHighlightColor = 'transparent';
</script>
</body>
</html>
